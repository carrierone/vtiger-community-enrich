function getCookie(b){var e=b+"=";var a=document.cookie.split(";");for(var d=0;d<a.length;d++){var f=a[d];while(f.charAt(0)===" "){f=f.substring(1,f.length)}if(f.indexOf(e)===0){return f.substring(e.length,f.length)}}return null}function getLinkedinIdentity(a){if(!a){a=window.location.pathname}a=a.replace("https://www.linkedin.com/in/","");a=a.replace("/in/","");split=a.split("/");return split[0]}function getLinkedinSalesIdentity(a){if(!a){a=window.location.pathname}a=a.replace("/sales/people/","");split=a.split(",");return split[0]}function getLinkedinSalesProfileInformation(c,f){var a=jQuery.Deferred();var d=getCookie("JSESSIONID").replace(/\"/g,"");var b=getLinkedinSalesIdentity(c);var e=localStorage.getItem("sales-profile-"+b);if(e&&e.length>1){a.resolve(JSON.parse(e))}else{$.ajax({url:"https://www.linkedin.com/sales-api/salesApiProfiles/(profileId:"+b+",authType:NAME_SEARCH,authToken:_s6x)?decoration=%28entityUrn%2CobjectUrn%2CpictureInfo%2CprofilePictureDisplayImage%2CfirstName%2ClastName%2CfullName%2Cheadline%2CmemberBadges%2Cdegree%2CprofileUnlockInfo%2Clocation%2ClistCount%2Cindustry%2CnumOfConnections%2CinmailRestriction%2CsavedLead%2CdefaultPosition%2CcontactInfo%2Csummary%2CcrmStatus%2CpendingInvitation%2Cunlocked%2CrelatedColleagueCompanyId%2CnumOfSharedConnections%2CshowTotalConnectionsPage%2CblockThirdPartyDataSharing%2CconnectedTime%2CnoteCount%2CflagshipProfileUrl%2CfullNamePronunciationAudio%2Cmemorialized%2CfullNamePronunciationAudio%2Cpositions*%2Ceducations*%29",type:"GET",dataType:"json",headers:{"CSRF-Token":d,"x-li-lang":"en_US","x-li-page-instance":"urn:li:page:d_sales2_profile","x-restli-protocol-version":"2.0.0"},success:function(h){var g={};g.profileLink="https://www.linkedin.com/sales/people/"+b+",NAME_SEARCH";g.email=h.contactInfo.primaryEmail;g.company=h.defaultPosition?h.defaultPosition.companyName:"";g.experiences=h.positions;g.educations=h.educations;g.photourl=h.profilePictureDisplayImage?h.profilePictureDisplayImage.artifacts[0]["fileIdentifyingUrlPathSegment"]:"";g.name=h.fullName;g.title=h.headline;g.address=h.location;g.description=h.summary;g.website=h.contactInfo.websites?h.contactInfo.websites[0]["url"]:"";g.sourceDomain="Linkedin";localStorage.setItem("sales-profile-"+b,JSON.stringify(g));a.resolve(g)}})}return a.promise()}function getLinkedinProfileInformation(c,f){var a=jQuery.Deferred();var d=getCookie("JSESSIONID").replace(/\"/g,"");var b=getLinkedinIdentity(c);var e=localStorage.getItem("profile-"+b);if(e&&e.length>1){a.resolve(JSON.parse(e))}else{getBaiscInformation(d,b).then(function(g){getProfile(d,b).then(function(h){getExperiences(d,b).then(function(i){getEducations(d,b).then(function(j){getSkills(d,b).then(function(k){g.profileLink="https://www.linkedin.com/in/"+b+"/";g.email=h.Email;g.phone=h.Phones[0];g.website=h.Websites[0];g.company=i[0]?i[0].EmployerOrgName:"";g.experiences=i;g.educations=j;g.skills=k;localStorage.setItem("profile-"+b,JSON.stringify(g));a.resolve(g)})})})})})}return a.promise()}function getImageUrl(c){var b;if(c=c["com.linkedin.common.VectorImage"]){var a=c.rootUrl;width=0;c.artifacts.forEach(function(e,d){if(e.width>width){width=e.width;b=a+e.fileIdentifyingUrlPathSegment}})}return b}function getBaiscInformation(c,b){var a=jQuery.Deferred();$.ajax({url:"https://www.linkedin.com/voyager/api/identity/profiles/"+b,type:"GET",dataType:"json",headers:{"CSRF-Token":c},success:function(f){var d="";if(miniProfile=f.miniProfile){if(vectorImage=miniProfile.picture){d=getImageUrl(vectorImage)}}var e={photourl:d,name:f.firstName+" "+f.lastName,title:f.headline,address:f.locationName,description:f.summary,sourceDomain:"Linkedin"};a.resolve(e)},error:function(d){a.resolve(null)}});return a.promise()}function getProfile(d,c){var a=jQuery.Deferred();var b=[];var e=[];$.ajax({url:"https://www.linkedin.com/voyager/api/identity/profiles/"+c+"/profileContactInfo",type:"GET",dataType:"json",headers:{"CSRF-Token":d},success:function(f){if(phoneNumbers=f.phoneNumbers){if(phoneNumbers.length){phoneNumbers.forEach(function(g){b.push(g.number)})}}if(socialWebsites=f.websites){if(socialWebsites.length){socialWebsites.forEach(function(g){e.push(g.url)})}}profile={Email:f.emailAddress,Phones:b,Websites:e};a.resolve(profile)}});return a.promise()}function getExperiences(c,b){var a=jQuery.Deferred();$.ajax({url:"https://www.linkedin.com/voyager/api/identity/profiles/"+b+"/positions?count=50&start=0",type:"GET",dataType:"json",headers:{"CSRF-Token":c},success:function(d){var e=[];d.elements.forEach(function(h,f){var j;var i=[];if(h.entityUrn.match(/urn:li:fs_position/)){if(company=h.company){i=company.industries}if(timePeriod=h.timePeriod){if(timePeriod.startDate.month){startDate=timePeriod.startDate.month+"/"+timePeriod.startDate.year}else{startDate=timePeriod.startDate.year}if(timePeriod.endDate){if(timePeriod.endDate.month){endDate=timePeriod.endDate.month+"/"+timePeriod.endDate.year}else{endDate=timePeriod.endDate.year}}else{endDate="Present"}if(startDate&&endDate){j=startDate+"-"+endDate}}var g={Title:h.title,EmployerOrgName:h.companyName,DateRange:j,Location:h.locationName,Description:h.description,Industries:i};e.push(g)}});a.resolve(e)}});return a.promise()}function getEducations(c,b){var a=jQuery.Deferred();$.ajax({url:"https://www.linkedin.com/voyager/api/identity/profiles/"+b+"/educations?count=50&start=0",type:"GET",dataType:"json",headers:{"CSRF-Token":c},success:function(d){var e=[];d.elements.forEach(function(h,g){var k;var j=[];var f;if(h.entityUrn.match(/urn:li:fs_education/)){if(timePeriod=h.timePeriod){if(timePeriod.startDate){f=timePeriod.startDate.year}if(timePeriod.endDate){endDate=timePeriod.endDate.year}else{endDate="Present"}if(f&&endDate){k=f+"-"+endDate}else{if(f){k=f}else{if(endDate){k=endDate}}}}var i={SchoolName:h.schoolName,DegreeName:h.degreeName,FieldOfStudy:h.fieldOfStudy,Grade:h.grade,DateRange:k,Comments:h.description};e.push(i)}});a.resolve(e)}});return a.promise()}function getSkills(c,b){var a=jQuery.Deferred();$.ajax({url:"https://www.linkedin.com/voyager/api/identity/profiles/"+b+"/skillCategory?includeHiddenEndorsers=true",type:"GET",dataType:"json",headers:{"CSRF-Token":c},success:function(d){skills=[];if(elements=d.elements){elements.forEach(function(e){if(endorsedSkills=e.endorsedSkills){endorsedSkills.forEach(function(f){skills.push({SkillName:f.skill.name,Endorsments:f.endorsementCount})})}});a.resolve(skills)}}});return a.promise()}function extractContactInfoValues(){var b=jQuery.Deferred();var c={};if(window.location.href.indexOf("linkedin.com/in")!=-1){getLinkedinProfileInformation(false).then(function(e){b.resolve(e)})}else{if(window.location.href.indexOf("linkedin.com/search/results/people")!=-1){var a=[];if($(".search-results-container").length==1){if($(".reusable-search__entity-results-list").length>1){var d=$(".reusable-search__entity-results-list").length;window.scrollTo(0,$(".reusable-search__entity-results-list")[d-1].scrollHeight/2);setTimeout(function(){window.scrollTo(0,$(".reusable-search__entity-results-list")[d-1].scrollHeight)},500)}setTimeout(function(){window.scrollTo(0,0);var e=$(".search-results-container .entity-result__title-text .app-aware-link");var f=e.length;$.each(e,function(h,j){var g=$(j).attr("href");if(g&&g!="#"&&g.split("/").length>0&&g.indexOf("linkedin.com/search/results")==-1){g=g.split("?")[0];getLinkedinProfileInformation(g).then(function(i){a.push(i);if(!--f){b.resolve(a)}})}else{if(!--f){b.resolve(a)}}})},1000)}else{setTimeout(function(){if($(".reusable-search__entity-results-list").length>1){var e=$(".reusable-search__entity-results-list").length;window.scrollTo(0,$(".reusable-search__entity-results-list")[e-1].scrollHeight/2);setTimeout(function(){window.scrollTo(0,$(".reusable-search__entity-results-list")[e-1].scrollHeight)},500)}setTimeout(function(){window.scrollTo(0,0);var f=$(".search-results-container .entity-result__title-text .app-aware-link");var g=f.length;$.each(f,function(j,k){var h=$(k).attr("href");h=h.split("?")[0];if(h&&h!="#"&&h.split("/").length>0&&h.indexOf("linkedin.com/search/results")==-1){getLinkedinProfileInformation(h).then(function(i){a.push(i);if(!--g){b.resolve(a)}})}else{if(!--g){b.resolve(a)}}})},1000)},2000)}}else{if(window.location.href.indexOf("linkedin.com/mynetwork/invite-connect/connections")!=-1){var a=[];setTimeout(function(){var e=$(".mn-connection-card .mn-connection-card__link");var f=e.length;var g=0;$.each(e,function(j,k){var h=$(k).attr("href");setTimeout(function(){if(h&&h!="#"&&h.split("/").length>0&&h.indexOf("linkedin.com/search/results")==-1){getLinkedinProfileInformation(h).then(function(i){a.push(i);if(!--f){b.resolve(a)}})}else{if(!--f){b.resolve(a)}}},g);g+=500})},1000)}else{if(window.location.href.indexOf("linkedin.com/sales/people/")!=-1){getLinkedinSalesProfileInformation(false).then(function(e){b.resolve(e)})}else{if(window.location.href.indexOf("linkedin.com/sales/search/people")!=-1){setTimeout(function(){if($(".search-results__result-list").length>0){var f=$(".search-results__result-list").length;window.scrollTo(0,$(".search-results__result-list")[f-1].scrollHeight/2);setTimeout(function(){window.scrollTo(0,$(".search-results__result-list")[f-1].scrollHeight)},500)}var e=[];setTimeout(function(){window.scrollTo(0,0);var g=$(".result-lockup__name").find("a");var h=g.length;var i=0;$.each(g,function(l,m){var k=$(m).attr("href");if(k&&k!="#"&&k.split("/").length>0&&k.indexOf("linkedin.com/search/results")==-1){var j=getLinkedinIdentity(k);var n=localStorage.getItem("profile-"+j);if(n&&n.length>1){e.push(c);if(!--h){b.resolve(e)}}else{setTimeout(function(){if(k&&k!="#"&&k.split("/").length>0&&k.indexOf("linkedin.com/search/results")==-1){getLinkedinSalesProfileInformation(k).then(function(o){e.push(o);if(!--h){b.resolve(e)}})}else{if(!--h){b.resolve(e)}}},i);i+=1500}}else{if(!--h){b.resolve(e)}}})},1000)},2000)}else{b.resolve([])}}}}}return b.promise()}function injectIcon(){localStorage.clear();var a=$("#extended-nav");if($("#openIframe").length!=0){return}if($(".eah-navigation-list").length){$(".eah-navigation-list").append('<li class="eah-navigation-list__item">\n                        <a class="ember-view eah-navigation-list__link" style="background-color:green;cursor:pointer;position:relative;">\n                            <span class="global-nav__primary-link ember-view" id="openIframe">\n                                <span aria-hidden="true" type="nav-small-jobs-icon" color="true">\n                                    <img src="'+chrome.runtime.getURL("assets/images/vtiger-logo.png")+'" style="width: 17px; font-weight:bolder;">\n                                </span>\n                                <span class="global-nav__primary-link-text" style="color:#fff">Enrich</span>\n                            </span>\n                            <span id="matchedRecordsCount" class="badge" style="height: 20px;width: 20px;color: white;position: absolute;right: -12px;border: 1px solid white;font-size: 13px;top: 2px;border-radius: 50px;background-color: green;text-align:center;">0</span>\n                        </a>\n                    </li>');return}if(a.length==0){$("#primary-navigation, .global-nav__nav").find(".global-nav__primary-items").append('<li class="global-nav__primary-item"  style="margin-left: 8px;background: #1cab5d; cursor:pointer;">\n                            <span class="global-nav__primary-link ember-view" id="openIframe">\n                                <span aria-hidden="true" type="nav-small-jobs-icon" color="true">\n                                    <img src="'+chrome.runtime.getURL("assets/images/vtiger-logo.png")+'" style="width: 24px;">\n                                </span>\n                                <span class="global-nav__primary-link-text" style="color:#fff">Enrich</span>\n                            </span>\n                            <span id="matchedRecordsCount" class="badge" style="height: 20px; width: 20px; color: white; position: absolute; right: 96px;border: 1px solid #3fab5d;font-size: 13px;top: 2px; line-height: 1.3;opacity:0;">0</span>\n                        </li>');$("#global-nav__nav").css("z-index","1000000");return}if(a.css("display")=="none"){$("#global-nav").find("nav").find(".global-nav__primary-items").append('<li class="global-nav__primary-item"  style="margin-left: 8px;background: #1cab5d; cursor:pointer;">\n							<span class="global-nav__primary-link ember-view" id="openIframe">\n								<span aria-hidden="true" type="nav-small-jobs-icon" color="true">\n									<img src="'+chrome.runtime.getURL("assets/images/vtiger-logo.png")+'" style="width: 24px;">\n								</span>\n								<span class="global-nav__primary-link-text" style="color:#fff">Enrich</span>\n							</span>\n							<span id="matchedRecordsCount" class="badge" style="height: 20px; width: 20px; color: white; position: absolute; right: 12px;border: 1px solid #3fab5d;font-size: 13px;top: 2px; line-height: 1.3;opacity:0;">0</span>\n						</li>');$("#global-nav").css("z-index","1000000")}else{$("#extended-nav").find("nav").find(".nav-container").append('<li id="jobs-nav-item" class="nav-item nav-item--jobs" lang="en" style="margin-left: 8px;background: #1cab5d; cursor:pointer;">\n							<span class="nav-item__link nav-item__link--underline" id="openIframe">\n								<span class="nav-item__icon" lang="en" role="presentation">\n									<li-icon aria-hidden="true" type="nav-small-jobs-icon" color="true">\n										<img src="'+chrome.runtime.getURL("assets/images/vtiger-logo.png")+'" style="width: 24px;margin-bottom: 5px;">\n									</li-icon>\n								</span> \n								<span class="nav-item__title" style="color:#fff">Enrich</span>\n							</span>\n							<span id="matchedRecordsCount" class="badge" style="height: 20px; width: 20px; color: white; position: absolute; right: 12px;border: 1px solid #3fab5d;font-size: 13px;top: 2px; line-height: 1.3;opacity:0;">0</span>\n						</li>');$("#extended-nav").css("z-index","1000000")}};